(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[910],{7757:function(e,s,t){Promise.resolve().then(t.bind(t,2311))},2311:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return i}});var r=t(3827),a=t(4090),n=t(5313),l=t(1654);function i(){let e=(0,n.useRouter)(),[s,t]=(0,a.useState)(""),[i,o]=(0,a.useState)(""),[d,u]=(0,a.useState)(!0),[c,m]=(0,a.useState)(null),[p,x]=(0,a.useState)(null);async function f(t){if(t.preventDefault(),m(null),x(null),s.length<8){m("Password must be at least 8 characters.");return}if(s!==i){m("Passwords do not match.");return}try{let{data:t,error:r}=await l.O.auth.updateUser({password:s});if(r){console.error("Update password error:",r),m(r.message||"Could not update password.");return}x("Password updated. Redirecting to login…"),setTimeout(()=>{e.replace("/login")},1500)}catch(e){console.error(e),m("Unexpected error updating password.")}}return((0,a.useEffect)(()=>{let e=!0;return async function(){let{data:s,error:t}=await l.O.auth.getSession();e&&((t||!s.session)&&m("Your reset link may have expired or is invalid. Please request a new one."),u(!1))}(),()=>{e=!1}},[]),d)?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 text-slate-100",children:"Checking your reset link…"}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 text-slate-100",children:(0,r.jsxs)("div",{className:"w-full max-w-md rounded-2xl border border-slate-800 bg-slate-900/90 px-8 py-10 shadow-xl",children:[(0,r.jsx)("h1",{className:"text-lg font-semibold mb-1",children:"Choose a new password"}),(0,r.jsx)("p",{className:"text-xs text-slate-400 mb-5",children:"Enter and confirm your new password for Fetti CRM."}),c&&(0,r.jsx)("div",{className:"mb-4 rounded-md bg-red-900/30 border border-red-500/60 px-3 py-2 text-xs text-red-200",children:c}),p&&(0,r.jsx)("div",{className:"mb-4 rounded-md bg-emerald-900/30 border border-emerald-500/60 px-3 py-2 text-xs text-emerald-200",children:p}),(0,r.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-xs text-slate-300",children:"New password"}),(0,r.jsx)("input",{type:"password",required:!0,value:s,onChange:e=>t(e.target.value),className:"w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-sm outline-none focus:border-fettiGreen focus:ring-1 focus:ring-fettiGreen",placeholder:"••••••••"})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-xs text-slate-300",children:"Confirm password"}),(0,r.jsx)("input",{type:"password",required:!0,value:i,onChange:e=>o(e.target.value),className:"w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-sm outline-none focus:border-fettiGreen focus:ring-1 focus:ring-fettiGreen",placeholder:"••••••••"})]}),(0,r.jsx)("button",{type:"submit",className:"mt-2 w-full rounded-lg bg-fettiGreen px-3 py-2 text-sm font-medium text-slate-950 hover:bg-lime-300",children:"Save new password"})]})]})})}},1654:function(e,s,t){"use strict";t.d(s,{O:function(){return l}});var r=t(140);let a="https://hgnpxdivozbmjagmshda.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhnbnB4ZGl2b3pibWphZ21zaGRhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM4NjQxODksImV4cCI6MjA3OTQ0MDE4OX0.aj6Va10UNNUUYQzNQfqA2ErUD_UvleR9I8klptAKIZU";if(!a||!n)throw Error("Missing Supabase environment variables. Set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY.");let l=(0,r.eI)(a,n);s.Z=l}},function(e){e.O(0,[140,971,69,744],function(){return e(e.s=7757)}),_N_E=e.O()}]);