"use strict";(()=>{var e={};e.id=569,e.ids=[569],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5757:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>U,originalPathname:()=>g,patchFetch:()=>j,requestAsyncStorage:()=>f,routeModule:()=>m,serverHooks:()=>I,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>_});var a={};r.r(a),r.d(a,{POST:()=>d});var i=r(5419),n=r(9108),o=r(9678),s=r(8070),p=r(4912);let c="https://hgnpxdivozbmjagmshda.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhnbnB4ZGl2b3pibWphZ21zaGRhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM4NjQxODksImV4cCI6MjA3OTQ0MDE4OX0.aj6Va10UNNUUYQzNQfqA2ErUD_UvleR9I8klptAKIZU";if(!c||!l)throw Error("Missing Supabase environment variables. Set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY.");let u=(0,p.eI)(c,l);async function d(e){try{let{applicationId:t,contact:r}=await e.json();if(!r||!r.firstName)return s.Z.json({error:"Missing required contact.firstName"},{status:400});let{data:a,error:i}=await u.from("contacts").insert({first_name:r.firstName,last_name:r.lastName??null,email:r.email??null,phone:r.phone??null}).select("id").single();if(i||!a)return console.error("Error inserting contact",i),s.Z.json({error:"Unable to create contact"},{status:500});let n=a.id,o=t??null;if(o){let{error:e}=await u.from("applications").update({contact_id:n}).eq("id",o);if(e)return console.error("Error updating application contact",e),s.Z.json({error:"Unable to update application contact"},{status:500})}else{let{data:e,error:t}=await u.from("applications").insert({contact_id:n,status:"STARTED"}).select("id").single();if(t||!e)return console.error("Error inserting application",t),s.Z.json({error:"Unable to create application"},{status:500});o=e.id}return s.Z.json({applicationId:o,contactId:n})}catch(e){return console.error("Unexpected error in /api/applications",e),s.Z.json({error:"Unexpected server error"},{status:500})}}let m=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/applications/route",pathname:"/api/applications",filename:"route",bundlePath:"app/api/applications/route"},resolvedPagePath:"/Users/fetti/Desktop/fetti_crm_saas_clean_fresh/app/api/applications/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:f,staticGenerationAsyncStorage:h,serverHooks:I,headerHooks:U,staticGenerationBailout:_}=m,g="/api/applications/route";function j(){return(0,o.patchFetch)({serverHooks:I,staticGenerationAsyncStorage:h})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[638,206,912],()=>r(5757));module.exports=a})();